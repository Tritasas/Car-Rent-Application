
            </div>
        </div>
    </body>
</html>

<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel" style="color: #02274c;">
    <div class="offcanvas-header">
      <h5 id="offcanvasRightLabel">ข้อมูลผู้ใช้งาน</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body" style="padding: 0px 20px;">

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    ชื่อ (TH) : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    ชื่อ (EN) : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    <%= user_data.cr_user_app_name_en %> <%= user_data.cr_user_app_surname_en %>
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    อีเมล : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    <%= user_data.cr_user_app_email %>
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    แผนก : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    <%= user_data.cr_user_app_division %>
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    ตำแหน่ง : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    <%= user_data.cr_user_app_job_title %>
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    สถานที่ทำงาน : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    <%= user_data.cr_user_app_office_location %>
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                    สถานะ : 
                </p>
                <p class="mb-0" style="font-weight: 700;">
                    <%= user_data.cr_user_row.enable %> 
                    <% if( user_data.cr_user_row.admin == "ใช่" ){ %>
                         , แอดมิน
                    <% } %>

                    <% if( user_data.cr_user_row.master_admin == "ใช่" ){ %>
                        , แอดมินใหญ่
                    <% } %>

                    <% if( user_data.cr_user_row.system_admin == "ใช่" ){ %>
                        , แอดมินระบบ
                    <% } %>
                </p>
            </div>
        </div>

        <div class="row" style="margin-top: 10px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 20px;">
            <div class="alert alert-secondary" role="alert" style="display: flex; margin: 0px; justify-content: space-between; background-color: #02274c; color: white;">
                <p class="mb-0">
                     
                </p>
                <a href="/user_log_out" class="btn btn-toggle align-items-center rounded collapsed sidebar-collapsed">
                    <div style="color: rgb(255, 70, 70);" ><i class="fas fa-sign-out-alt" style="margin-right: 5px;"></i> <span>ออกจากระบบ</span></div> <i></i>
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" >
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Modal body text goes here.</p>
            </div>
            <div class="modal-footer">
                <button style="width: 30%;" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button style="width: 50%;" type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Modal Heading</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Modal body..
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div id="modalReloading" class="modal fade bd-example-modal-lg" data-backdrop="static" data-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-sm" style="display: table; position: relative; margin: 0 auto; top: calc(50% - 24px);">
        <div class="modal-content" style="width: 48px; background-color: transparent; border: none;">
            <span class="fa fa-spinner fa-spin fa-3x"></span>
        </div>
    </div>
</div>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" 
crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
<script src="/assets/js/jquery.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script> -->
<script src="/assets/js/popper.min.js"></script>

<script src="/assets/js/vendor-all.min.js"></script>
<script src="/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="/assets/plugins/datatables/js/datatables.js"></script>
<script src="/assets/js/pcoded.min.js"></script>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script> -->
<script src="/assets/js/bootstrap-select.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script> -->

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" integrity="sha512-fD9DI5bZwQxOi7MhYWnnNPlvXdp/2Pj3XSTRrFs5FQa4mizyGLnJcN6tuvUS6LbmgN1ut+XGSABKvjN0H6Aoow==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
<script src="/assets/js/all.min.js"></script>

<!-- <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.js"></script> -->
<script src="/assets/js/jquery.dataTables.js"></script>

<!-- <script src="https://cdn.datatables.net/fixedcolumns/4.3.0/js/dataTables.fixedColumns.min.js"></script> -->
<script src="/assets/js/dataTables.fixedColumns.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> -->
<script src="/assets/js/bootstrap.bundle.min.js"></script>

<script src="/assets/js/sheet.js"></script>

<script src="js/three.min.js"></script>
<script src="js/panolens.min.js"></script>

<script>

    function openModalReloading(){
        console.log("openModalReloading")
       $('#modalReloading').modal('show');
    }

    function closeModalReloading(){
        console.log("closeModalReloading")
        setTimeout(function () {
       	$('.modal').modal('hide');
       }, 500)
    }

    function confirm_create_new_document_car_rent(){
        Swal.fire({
            icon: "question",
            title: "ยืนยันสร้างเอกสารใหม่",
            html: `
                โปรดเลือกประเภทเอกสารใหม่ที่ต้องการสร้าง <br><br><hr>
                <a href="/car_rent_document_create" style="cursor: pointer; width: 100%;">
                    <button type="button" class="btn btn-primary" style="color: white; width: 100%;">
                        <i class="fa-solid fa-car-side" style="margin-right: 5px;"></i>
                        สร้างเอกสารขอยืมรถยนต์
                    </button>
                </a>
                <br><br>
                <a href="/ticket_request_document_create" style="cursor: pointer; width: 100%;">
                    <button type="button" class="btn btn-primary" style="color: white; width: 100%;">
                        <i class="fa-solid fa-ticket" style="margin-right: 5px;"></i>
                        สร้างเอกสารขอตั๋วเดินทาง Bolt , Grab
                    </button>
                </a>
            `,
            focusConfirm: true,
            showCloseButton: false,
            showConfirmButton: false,
            confirmButtonText: `ยืนยัน, สร้าง`,
            showCancelButton: false,
            cancelButtonText: `ปิด`
        }).then((result) => {
            if (result.isConfirmed) {
                window.location = "/car_rent_document_create"
            }
        });
    }

    const mobileScreen = window.matchMedia("(max-width: 990px )");

    function decodedString( string ){
        let decodedString_output = string.replace(/&#(\d+);/g, (match, code) => {
            return String.fromCharCode(code);
        });

        console.log("decodedString_output")

        if (decodedString_output.startsWith('"') && decodedString_output.endsWith('"')) {
            decodedString_output = decodedString_output.slice(1, -1);
            return decodedString_output
        }else{
            return decodedString_output
        }
    }

    function set_date_templece( date , syntax , type ){
        let day = (new Date(date)).getDate();
        let month = (new Date(date)).getMonth();
        let year = (new Date(date)).getFullYear();

        if( type == "en_short" ){
            return day.toString().padStart(2, '0') + syntax + (month + 1).toString().padStart(2, '0') + syntax + year.toString()

        }else if( type == "th_short" ){
            return day.toString().padStart(2, '0') + syntax + (month + 1).toString().padStart(2, '0') + syntax + (year + 543).toString()

        }else if( type == "en_long" ){
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];

            return day.toString().padStart(2, '0') + " " + monthNames[month] + " " + year.toString()

        }else if( type == "th_long" ){
            const thaiMonths = [
                "มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน",
                "กรกฎาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"
            ];
            return day.toString().padStart(2, '0') + " " + thaiMonths[month] + " " + (year + 543).toString()

        }else{
            return ""

        }
    }

    $(document).ready(function () {
        $(".dashboard-nav-dropdown-toggle").click(function () {
            $(this).closest(".dashboard-nav-dropdown")
                .toggleClass("show")
                .find(".dashboard-nav-dropdown")
                .removeClass("show");
            $(this).parent()
                .siblings()
                .removeClass("show");
        });
        $(".menu-toggle").click(function () {
            if (mobileScreen.matches) {
                $(".dashboard-nav").toggleClass("mobile-show");
            } else {
                $(".dashboard").toggleClass("dashboard-compact");
            }
        });
    });

    window.addEventListener('beforeunload', () => {
        sessionStorage.setItem('scrollPosition', window.scrollY.toString());
    });

    // Restore scroll position on page load
    window.addEventListener('load', () => {
        const scrollPosition = sessionStorage.getItem('scrollPosition');
        if (scrollPosition) {
            window.scrollTo(0, parseInt(scrollPosition, 10));
        }
    });

    // document.addEventListener("DOMContentLoaded", function(event) { 
    //     var scrollpos = localStorage.getItem('scrollpos');

    //     if(localStorage.getItem('old_url') == window.location.href){
    //         console.log("same URL")
    //         if (scrollpos) window.scrollTo(0, scrollpos);

    //     }else{
    //         scrollpos = 0
    //         console.log("Diff URL")
    //         if (scrollpos) window.scrollTo(0, scrollpos);
    //     }
    // });

    // window.onbeforeunload = function(e) {
    //     localStorage.setItem('old_url', window.location.href);
    //     localStorage.setItem('scrollpos', window.scrollY);
    // };

    function back_page(){
        console.log("000000000000000000000000000000000000000000")
        localStorage.setItem('reload', "true");
        window.history.back();
    }

    reload_check()

    function reload_check(){
        console.log("asdhasudh")
        console.log("localStorage.getItem('reload')")
        console.log(localStorage.getItem('reload'))
        if( localStorage.getItem('reload') == "true" ){
            console.log("85485484846546848")
            localStorage.setItem('reload', "false");
            window.location.reload();
        }
    }

    function backToFirstVisited () {
        var moves = window.history.length - 1;
        window.history.go(-moves);
    }

    function export_data_to_excel(type , table_id){
        const fileName = 'exported-sheet.' + type
        const table = document.getElementById(table_id)
        const wb = XLSX.utils.table_to_book(table)
        XLSX.writeFile(wb, fileName)
    }

</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.4/html5-qrcode.min.js" integrity="sha512-k/KAe4Yff9EUdYI5/IAHlwUswqeipP+Cp5qnrsUjTPCgl51La2/JhyyjNciztD7mWNKLSXci48m7cctATKfLlQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript" src="/assets/js/qrcode.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>